import React, { useEffect, useContext } from "react";
import PropTypes from "prop-types";
import Header from "./Header";
import Footer from "./Footer";
import Head from "next/head";
import { Context as AuthContext } from "../../context/AuthContext";
import { Context as UserContext } from "../../context/UserContext";
import { ToastContainer, Slide } from "react-toastify";
import styles from "../../styles/Layout.module.scss";

function Layout({ children, brandName }) {
  const {
    state: { auth },
    getAuth,
  } = useContext(AuthContext);
  const { getUserCart } = useContext(UserContext);

  useEffect(() => {
    getAuth();
  }, []);

  useEffect(() => {
    if (auth?.status === "SIGNED_IN") {
      getUserCart({ id: auth.user._id });
    }
  }, [auth]);

  return (
    <div className={styles.container}>
      <Head>
        <title>Traverston</title>
        <meta name="description" content="Generated by create next app ok" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <ToastContainer
        theme="dark"
        position="bottom-right"
        transition={Slide}
        autoClose={3000}
        hideProgressBar={true}
        newestOnTop={false}
        closeOnClick
        rtl={false}
        pauseOnFocusLoss
        draggable
        pauseOnHover
      />
      {/* Same as */}
      {/* <ToastContainer /> */}
      <Header brandName={brandName} />

      <main className={styles.main}>{children}</main>

      <Footer />
    </div>
  );
}

Layout.propTypes = {
  children: PropTypes.object,
  brandName: PropTypes.string,
};

export default Layout;
